<%- include('header.ejs') %>
<main class="mw">
    <h2>예지'S BLOG</h2>

    <div class="detailCon">
        <div class="cont">
            <div class="img"><img src="/<%= post.postImgPath %>" alt=""></div>
            <label for="date" hidden>작성일</label>
            <input type="date" id="date" name="date" hidden>   
            <p class="title"><%= post.title %></p>
            <p class="content"><%= post.content %></p>
        </div>
        <div class="btnArea">
            <a href="/edit/<%= post._id %>">수정</a>
            <button class="delBtn" data-postnum="<%= post._id %>">삭제</button>
            <a href="/">목록</a>
        </div>
    </div>
</main>

<script>
    const date = document.querySelector('#date');
    const today = new Date().toISOString().slice(0, 10);
    date.value = today;

    const delBtn = document.querySelector('.delBtn')
    delBtn.addEventListener('click', (e)=>{
        fetch('/delete', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                postNum: e.target.dataset.postnum
            })
        }).then(res => {
            if(res.ok){
                location.href='/'
            } else {
                console.log('삭제 실패');
            }
        })
    })
</script>
<%- include('footer.ejs') %>